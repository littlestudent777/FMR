# Калькулятор частоты ферромагнитного резонанса (ФМР)

Программа для расчёта частоты ферромагнитного резонанса с учётом влияния:
- внешнего магнитного поля
- размагничивающего поля
- кубической анизотропии
и их комбинаций

## Выражение для угловой частоты
$$\omega_r = \frac{\gamma}{M_s sin(\theta)} (F_{\theta \theta} F_{\phi \phi} - F_{\theta \phi}^2)^{\frac{1}{2}}$$  
(J.Smit, H.G. Beljers), 
где вторая производная берётся в равновесном состоянии.  
Формула не может быть использована при $sin(\theta) \approx 0$. 

## Обработка случая $sin(\theta) \approx 0$
Если вектор намагниченности близок к оси z, система координат поворачивается на угол $\frac{\pi}{2}$ вокруг оси y, чтобы избежать вырождения.

## Вычисление производных
Производные второго порядка $(F_{\theta \theta}, F_{\phi \phi}, F_{\theta \phi)$ вычисляются символьно с помощью библиотеки SymPy.  
Подробнее:  
1. Каждый класс поля (ExternalField, DemagnetizingField, Anisotropy) определяет энергию как символьное выражение.

2. Преобразование в сферические координаты:
Энергия преобразуется из декартовых координат в сферические с использованием подстановки:
$$
x = sin(\theta) * cos(\phi)  
y = sin(\theta) * sin(\phi)  
z = cos(\theta)
$$

3. Вычисление производных:
Для преобразованной энергии вычисляются вторые производные по сферическим углам.

4. Подстановка численных значений:
В полученные символьные выражения производных подставляются в численные значения углов и параметров сил.

5. Производные от всех полей суммируются, и итоговые значения используются для расчета частоты ферромагнитного резонанса (ФМР).

## Результаты
Для нескольких конфигураций была посчитана частота ФМР по указанной формуле, а также исходя из частоты колебаний одной из поперечных компонент намагниченности, которая была посчитана из численного решения уравнения ЛЛГ (https://github.com/littlestudent777/LLG_equation (функция ‎LLGSolver.compute_frequency)).

| Конфигурация эксперимента              | ФМР по формуле С.-Б. (ГГц) | Частота колебаний компоненты намагниченности (ГГц) |
|----------------------------------------|----------------------------|----------------------------------------------------|
| Внешнее поле (H = [600, 250, 1000] G)  | 3.341                      | 3.343                                              |
| Внешнее поле (H = [800, 1000, 350] G)  | 3.719                      | 3.703                                              |
| Анизотропия (K1 = 4.2e5, K2 = 1.5e5)   | 1.378                      | 1.377                                              |
| Анизотропия (K1 = -4.2e5, K2 = 1.0e5)  | 0.846                      | 0.845                                              |
| Размагничивающее поле (цилиндр, z=inf) | 30.043                     | 30.026                                             |
| Комбинация эффектов                    | 12.260                     | 12.257                                             |

Результаты сошлись с точностью до первого знака после запятой.
